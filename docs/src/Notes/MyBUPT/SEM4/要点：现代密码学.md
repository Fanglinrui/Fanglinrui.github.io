# 第一讲  
* 密码学目的  
	* 安全属性：机密性、完整性、认证性、不可抵赖性、可用性  
		* 对称、非对称都有机密性和完整性  
		* 对称 有不可抵赖性  
		* 认证性有实体认证和消息源认证  
		* 身份鉴别是实体认证  
		* 消息认证码是源认证
* 攻击
	* 前提条件（越靠下越难抵御，越靠上越难攻击）  
		* 唯密文攻击  
		* 已知明文攻击  
		* 选择明文攻击  
		* 选择密文攻击  
	* TIP：Kerckhoff假设：密码分析者知道明文的统计特性、加密体制、密钥空间及其统计特性，但不知道所解惑的密文所使用的密钥  
# 第二讲  
* 仿射密码，解密要求乘数的逆
* 希尔密码
	* 加密：$c=p*K \mod 26$  
	* 解密：$p=c*K^{-1} \mod 26$  
	* 计算逆的方法：
		* 辗转相除
	* 解一元同余式的方法：
		* 判断(a,m)|b否？解数为(a,m)  
		* 求a/(a,m)关于m/(a,m)的逆  
		* 计算 逆 x b/(a,m) 全等 ？mod m/(a,m)  
# 第三讲  
* Shannon的通信保密系统  
	* 加密密钥、解密密钥、加密算法、解密算法、明文、密文、DE=I，其中I为恒等映射  
	* 假设密钥信道是安全信道  
* 完美保密：H(P)=H(P|C)
* 复杂度理论  
	* 问题：
		* 判定问题：Y/N  
		* 计算问题：从可行解集合中选出最优解  
	* 算法  
	* 算法复杂度  
		* [[3 现代密码学第三讲：密码学基础.pdf#page=32&selection=79,0,81,6|这里的100/ln100是怎么来的？]] ——根据素数定理  
		* 时间（计算）复杂性：考虑算法的主要操作步骤    
		* 空间复杂性：执行所需的存储器单元数目  
	* **多项式时间算法**：计算复杂度为$O(n^t)$, t为常数，n为问题长度，称算法的复杂度是多项式的  
	* **指数时间算法**：$O(t^{h(n)})$  
* 问题复杂性：  
	* P问题：如果一个问题可以找到一个能在多项式的时间里解决它的算法，那么这个问题就属于P问题
	* NP问题：可以在多项式的时间里验证一个解的问题。*另一个定义是，可以在多项式的时间里猜出一个解的问题。*  
		* 求解：猜测——》验证  
	* NP完全问题（NPC）
		* 是一个NP问题  
		* NP中任何一个问题都可多项式时间转化为的NP问题称为NPC  
	* NP-hard
		* 只满足第二条  
# 第四讲  
* 分组密码的安全性原则：
	* 混乱与扩散：
		* 混乱：打乱密文、明文、密钥之间的依赖关系  
		* 扩散：明文/密钥的一个bit变化会引起密文多个bit的变化
			* 消弭明文的统计特征
			* 雪崩效应：明文一个比特变化引起密文多个比特变化，且变化的比特未知  
* 设计结构：
	* Feistel结构（费斯妥），  
		* $L_{i+1}=R_i$  
		* $R_{i+1}=L_i \oplus F(R_i,K_i)$ 
	* SPN网络（代换-置换网络）——S盒P盒  
* DES：解密和加密的费斯妥结构相同！
	* 输入：64（每次加密右半32） ； 密钥：64（56）；轮次：16
	1. IP置换查表  
	2. 16轮迭代——最后1轮再把左右换回来（等于不交换）——走的是$(R_{16},L_{16})$   
		1. 对右半部分E扩展  4列8行扩展为6列8行，增加的列数为每一行顺延两位
		2. 与密钥加  
			* 密钥生成：
				1. 仅第一次：64bit 经过PC-1 变为56bit  
				2. 分成左右两部分，分别循环左移
					* 1、2、9、16左移一位，其它两位
				3. 过PC-2，得到48bit
		1. 过S盒（首尾为行，中4为列）
		2. P置换
	3. IP逆置换查表
* AES： SPN结构  
	* 输入：128位，密钥：128/192/256，轮：10/12/14
	1. 明文先过一次加法层  
	2. 9轮完整层  +1轮没有列混合的，共10轮
		1. 字节代换——过S盒（首4为行，低4为列）  
		2. 扩散    
			1. 行移位，分别移位0，1，2，3  
			2. 列混合，乘一个固定的矩阵  
		3. 密钥加法  
			* 密钥编排：  
				* `W[4i]=W[4(i-1)]+g(W[4i-1])`  
				* `W[4i+j]=W[4(i-1)+j]+W[4i+j-1]`  
				* G函数还有具体操作，注意存在一个轮系数  
* 工作模式：  
	* ECB，密码本模式，就是一组一组对着做  
		* 无法隐藏数据结构  
	* CBC，分组链接，参考MAC，每个生成的结果要与下一组的明文异或，然后再进入加密函数  
		* 最后一个分组包含填充
	* CFB，密码反馈，异步序列密码/自同步流密码（两个是一个意思）  
		* 无需填充，隐藏数据结构
	* OFB，输出反馈，同步序列密码/同步流密码  
		* 克服了CBC，和CFB的错误传播
	* CTR，计数器模式  
		* 无需填充，只调用加密算法，无错误传播，密文有扩展  
# 第五讲 流密码  
* 基于线性反馈移位寄存器的伪随机数发生器  
	* 在有n级的情况下  
		* $a_{n+1}=c_1a_n+...+c_na_1$   
		* 每一级的角标和是相同的  
		* 产生的角标最大的
		* 输出的是角标最小的  
	* 多项式表示  
		* $p(x)=1+c_1x+c_2x^2...+c_nx^n$   
		* 次数与角标相同，多了个1  
		* 常见的本原多项式：(0,1,2), (0,1,3), (0,1,4), **(0,2,5)**,  (0,1,6), (0,1,7), **(0,1,3,4,8)**, (0,1,9)，可以看到很明显的规律性，只用记几个特殊的就行  
* 破译：  
	* 从第二轮的地方开始（比如5级，那就从a6开始），按照规律作出矩阵  
	* 对矩阵求逆即可，用扩展方式  
# 第六讲 哈希函数和消息鉴别码  
## 6.1 HASH  
* 中国：SM3
* 保证了完整性  
* 安全属性：  
	* 抗原像  $2^n$
	* 抗第二原像  $2^n$
	* 抗碰撞  $2^{\frac{n}{2}}$   
* 某些常见的HASH函数的一些信息  

| 算法          | 输出长度    | 碰撞       |
| ----------- | ------- | -------- |
| SHA-0       | 160     | yes      |
| SHA-1       | 160     | $2^{63}$ |
| SHA-256/224 | 256/224 | none     |
| SHA-512/384 | 512/384 | none     |
* 生日攻击  
## 6.2 MAC  
# 第七讲 公钥密码学  
## 7.1 RSA  
* 密钥的产生  
	* 选取大素数 $p,q$  
	* 计算 $n=p \times q, \varphi(n)=(p-1)(q-1)$  
	* 选一整数$e$ ,满足$1<e<\varphi(n), \gcd (\varphi(n),e)=1$  
	* 计算$d$, 满足$d \cdot e \equiv 1 \mod \varphi(n)$   
	* {e, n}为公钥，{d, n}为私钥  
* 加密  
	* $c \equiv m^e \mod n$  
* 解密  
	* $m \equiv c^d \mod n$  
* 模平方重复算法，注意一下  
* 参数选择问题：  
	* p,q 尽量大，p-1和q-1都应有大的素因子  
	* e不能取太小  
	* 解密指数比较大
	* 共模攻击：n不能取相同的  
		* e不同且互素时，可以恢复m  
		* 互素时可以求得r、s，计算$c_1^r \cdot c_2 ^s$ 直接出m  
* 是确定性加密，有同态性，在真正使用时，是OAEP模式  
## 7.2 ElGamal  
* 密钥生成  
	* 选取大素数 $p$, 以及 $Z^*_p$ 的生成元 $g$  
	* 任选小于p的随机数 $x$ , 计算$y \equiv g^x \mod p$  
	* $(y, g, p)$为公钥，$(x, g ,p)$为密钥  
* 加密：M  
	* 随机整数 $k$ ,0<k<=p-1  
	* 计算密文对：$C = \{C_1,C_2\}$  
		* $C_1 \equiv g^k \mod p$  
		* $C_2 \equiv y^kM\mod p$  
			* $K =y^k \mod p$  
* 解密：  
	* $M = \frac{C_2}{C^x_1} \mod p$  
		* 首先计算K，也就是$C_1^x$   
		* 然后计算$K^{-1} \mod p$  
		* 然后$K^{-1}$ 与$C_2$ 直接相乘即可  
* 是有限域上的离散对数问题  
* 随机算法，但是不抗选择攻击，需要封装
* 参数误用：  
	* 泄露  
	* 复用
## 7.3 椭圆曲线  
* 不考计算  
* ![[现代密码学每章要点总结.png]]  
* $x_A$密钥，$P_A=x_AG$公钥  
* 加密：$C_m=\{kG,P_m+kP_A\}=\{c_1,c_2\}$  
* 解密：用第二个点减去密钥与第一个点的倍乘
# 第八讲 数字签名  
* 安全模型及攻击结果  
	* 安全模型：  
		* 唯密钥攻击  
		* 已知消息攻击  
		* 选择消息攻击  
	* 攻击结果：  
		* 完全破译：恢复出私钥  
		* 一致伪造：对于任意消息伪造签名  
		* 选择伪造：对一个自己选取的消息进行伪造  
		* 存在性伪造：可以生成一些消息的签名  
* RSA签名：  
	* 签名者用**私钥d**签名：$s=m^d \mod n$  
	* 验证者用**公钥e**验证：$m'=s^e \mod n$  
	* 唯密钥攻击存在性伪造：选择一个数作为签名，再计算其e次幂作为消息  
		* 因此对消息的hash值签名  
		* 抗原像——抗唯密钥攻击  
		* 抗第二原像——抗已知消息攻击  
		* 抗碰撞——抗选择消息攻击  
**有限域上的离散对数签名**  
* ElGamal签名：
	* $y^rr^s=g^{H(m)} \mod p$  
	* $r=C_1$  
	* $s=(H(m)-xr)k^{-1}(\mod p-1)$  
	* 引入H(m)抵抗存在性伪造  
* Schnorr签名：  
	* $g^sy^{-c}=g^k$  
	* $c=h(m||g^k)$ 
	* $s=k+xc \mod q$  
* DSA:  
	* $g^my^r=r^s \mod p$ 签名：(r,s)  
	* $s=(m+xr)k^{-1} \mod q$  
	* $r = C_1 \mod q$  
	* m经过sha-1  
	* 验证：$r=(g^{ms^{-1}\mod q}y^{rs^{-1}\mod q}\mod p)\mod q$  
* 泄露k:  
	* ![[现代密码学每章要点总结-1.png]]  
* 椭圆曲线签名：  
	* 密钥生成同椭圆曲线  
	* 生成元G的阶为q
	* 签名：  
		* $h_1=h(m)$  
		* $kG=(k_x,k_y), r=k_x$  
		* $s=(h+rx)k^{-1}\mod q$  
	* 验证：  
		* 计算$h_1$  
		* $u=s^{-1}h_1 \mod q$  
		* $v=s^{-1}r \mod q$  
		* $(x,y)=uG+vY$  
		* 比较$r=x \mod p$  成立否？
* 加密认证方式：  
	* 保证保密性与认证性  
	* 先加密、再密文签名——内部保密  
	* 先对明文签名、再明文及签名一起加密——外部保密（建议）  
# 第九讲 密钥管理  
* 柯克霍夫原则：即使密码系统的任何细节已为人悉知，只要密钥未泄露，它也应该是安全的  
* 密钥管理：生成、建立（分配和协商）、存储、使用、备份/恢复、撤销、更新、存档和销毁  
	* 生成：随机性、不可预测性  
	* 建立：完整性、保密性  
* 会话密钥、密钥加密密钥、主密钥：层次依次升高，会话密钥又称数据加密密钥，用后清除  
* 数字证书：  
	* PKI：公钥基础设施
	* RA处理来自申请人的注册表格，通过后交给CA，CA反馈注册结果给RA，RA再给申请人，申请人再直接请求CA，CA响应后再发布  
* 秘密共享：  
	* <t个人一定不行，>=t一定能恢复  
* 密钥托管：  
	* 目的：为了有效控制密码技术的使用，保证对个人没有绝对的隐私和绝对不可跟踪的匿名性  
	* 用途：提供备用解密途径，政府/用户可查  
# 第十讲 密码协议  
* 协议：有效性、公平性、完整性  
* 零知识证明：完备性、有效性、零知识性  
* 比特承诺：屏蔽性、绑定性  
* 安全多方计算：比如百万富翁问题，平均薪水问题，共同兴趣问题，加密数据计算，不经意传输  
* 公平掷币协议：基本流程即可  
