---
tags:
  - 操作系统
  - 虚拟化
  - 快速地址转换
  - 分页
参考: "[[操作系统导论 (Remzi H. Arpaci-Dusseau etc.) (Z-Library).pdf#page=154&selection=13,0,38,0|操作系统导论 (Remzi H. Arpaci-Dusseau etc.) (Z-Library), page 154]]"
aliases:
  - TLB
updateTime: 2025-04-11 16:48
---
# 背景  
* 分页方式实现地址的虚拟化，开销太大：  
	* 二次访存  
* 关键问题：如何加速地址转换？  
	* 如何做？  
	* 硬件要怎样支持？  
	* 操作系统要怎样支持？  
# 第1部分 概况  
* TLB：translation-lookaside buffer 地址转换旁路缓存存储器  
* 流程：  
	 首先从虚拟地址提取VPN(页号)，然后检查TLB  
		1. 命中：  
			1. 从TLB取出页帧号(FPN)，加上偏移量  
			2. 访存共一次  
		2. 未命中：  
			1. 访问页表（第1次访存）  
			2. 访问物理地址（第2次访存）  
* 因为存在**时间局部性**和**空间局部性**，命中率很高  
* 处理 *未命中* 的两种思路：  
	1. CISC/硬件处理：遍历页表——如x86  
	2. RISC/操作系统处理：抛出一个*异常*  
		* 这里的异常稍有不同：处理完异常后要执行**触发前**的指令  
# 第2部分 TLB的内容  
* 有32/64/128项  
* 每项内容：  
	* VPN | PFN | 其它位  
		* 其他位：有效位，保护位，地址空间标识符(ASID)，脏位等
* 全相联  
* 进程切换怎么办？  
	* 一种方法是直接清空  
	* 另一种方法是增加ASID，用于标识进程  
* 替换：随机替换  
