---
tags:
  - "#哈希函数"
  - hash
参考: "[[6.1_hash和MAC.pdf]]"
---
# 第一部分 概况  
* Hash函数，又称哈希函数，杂凑函数  
	* 将任意长度的消息x压缩为固定长度的值y
* 功能：保证数据的**完整性**  
* 基本属性：
	* 压缩性
	* 有效性——任意给定的消息计算都很方便  
	* **安全属性**
		* 抗原像（单向性）
		* 抗第二原像  
		* 抗碰撞  

| 抗原像   | 抗第二原像 | 抗碰撞       |
| ----- | ----- | --------- |
| $2^n$ | $2^n$ | $2^{n/2}$ |
## 1.1 #生日攻击  
* 生日问题  
	* m个人中，至少有两人生日相同的概率大于0.5，m应取多大  
		* m=23
		* 重要式子： $e^{-x} \approx 1-x$  
		* 可以得到推广，$m \approx 1.17\sqrt {N}$ ,N为结果空间大小  
* 定理：设哈希函数的输出值长n比特，那么经过$2^{n/2}$ 次杂凑运算，找到一对碰撞的概率大于0.5
	* $N=2^n$
	* $\sqrt{N}=n^{n/2}$  
# 第二部分 构造方法  

## 2.1 [[6.1_hash和MAC.pdf#page=31&selection=4,0,5,4|基于数学困难问题  ]]
## 2.2 基于分组密码  
* [[6.1_hash和MAC.pdf#page=32&selection=4,0,4,9|杂凑值等于分组长度]]  
* [[6.1_hash和MAC.pdf#page=35&selection=4,0,4,9|杂凑值大于分组长度]]：MDC-2, MDC-4等
## 2.3 定制 Hash 函数  
### 2.3.1 一般模型  
* **任意长度输入**，经过 *迭代压缩函数* 后产生**固定长度输出**，再经过可选的输出变换得到输出  
* 更具体来说：
	* 预处理：附加填充位 后 附加长度块 得到 格式化输入$x=x_1x_2x_3...x_t$  
	* 迭代处理：对 $x_i$ 进行操作，它与上一轮的 $H_{i-1}$ 一起经过压缩函数 f， 得到的 $H_i$ 再经过多轮迭代得到最后的 $H_t$ ,$H_t$ 在经过函数g，得到输出$h(x)=g(H_t)$ 
	* 如下图  
* ![[HASH函数.png]]  
### 2.3.2 主要结构  
* MD 结构  
* 宽管道和双管道结构  
* HAIFA 结构  
* 海绵结构  
### 2.3.3 几种填充手段  
1. [[6.1_hash和MAC.pdf#page=53&selection=8,0,9,2|MD4]]
2. [[6.1_hash和MAC.pdf#page=70&selection=2,0,5,4|SHA-256]]  